"use strict";(self.webpackChunkdocuments_viewer=self.webpackChunkdocuments_viewer||[]).push([[83],{6083:(ds,Qt,d)=>{d.r(Qt),d.d(Qt,{DocumentModule:()=>cs});var g=d(177),T=d(1669),Sn=d(467),r=d(4438),D=d(1985),N=d(6977);function B(e){e||((0,r.Af3)(B),e=(0,r.WQX)(r.abz));const n=new D.c(t=>e.onDestroy(t.next.bind(t)));return t=>t.pipe((0,N.Q)(n))}var q=d(7673),pt=d(8359);class Fn extends pt.yU{constructor(n,t){super()}schedule(n,t=0){return this}}const Y={setInterval(e,n,...t){const{delegate:i}=Y;return i?.setInterval?i.setInterval(e,n,...t):setInterval(e,n,...t)},clearInterval(e){const{delegate:n}=Y;return(n?.clearInterval||clearInterval)(e)},delegate:void 0};var On=d(7908);class mt extends Fn{constructor(n,t){super(n,t),this.scheduler=n,this.work=t,this.pending=!1}schedule(n,t=0){var i;if(this.closed)return this;this.state=n;const s=this.id,o=this.scheduler;return null!=s&&(this.id=this.recycleAsyncId(o,s,t)),this.pending=!0,this.delay=t,this.id=null!==(i=this.id)&&void 0!==i?i:this.requestAsyncId(o,this.id,t),this}requestAsyncId(n,t,i=0){return Y.setInterval(n.flush.bind(n,this),i)}recycleAsyncId(n,t,i=0){if(null!=i&&this.delay===i&&!1===this.pending)return t;null!=t&&Y.clearInterval(t)}execute(n,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const i=this._execute(n,t);if(i)return i;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(n,t){let s,i=!1;try{this.work(n)}catch(o){i=!0,s=o||new Error("Scheduled action threw falsy error")}if(i)return this.unsubscribe(),s}unsubscribe(){if(!this.closed){const{id:n,scheduler:t}=this,{actions:i}=t;this.work=this.state=this.scheduler=null,this.pending=!1,(0,On.o)(i,this),null!=n&&(this.id=this.recycleAsyncId(t,n,null)),this.delay=null,super.unsubscribe()}}}const gt={now:()=>(gt.delegate||Date).now(),delegate:void 0};class P{constructor(n,t=P.now){this.schedulerActionCtor=n,this.now=t}schedule(n,t=0,i){return new this.schedulerActionCtor(this,n).schedule(i,t)}}P.now=gt.now;class _t extends P{constructor(n,t=P.now){super(n,t),this.actions=[],this._active=!1}flush(n){const{actions:t}=this;if(this._active)return void t.push(n);let i;this._active=!0;do{if(i=n.execute(n.state,n.delay))break}while(n=t.shift());if(this._active=!1,i){for(;n=t.shift();)n.unsubscribe();throw i}}}const vt=new _t(mt),xn=vt;var Rn=d(8793),Zt=d(6697),U=d(9974),O=d(4360),In=d(5343),Tn=d(3703),Jt=d(1397),x=d(8750);function te(e,n){return n?t=>(0,Rn.x)(n.pipe((0,Zt.s)(1),function kn(){return(0,U.N)((e,n)=>{e.subscribe((0,O._)(n,In.l))})}()),t.pipe(te(e))):(0,Jt.Z)((t,i)=>(0,x.Tg)(e(t,i)).pipe((0,Zt.s)(1),(0,Tn.u)(t)))}var Nn=d(9470);function ee(e=0,n,t=xn){let i=-1;return null!=n&&((0,Nn.m)(n)?t=n:i=n),new D.c(s=>{let o=function Bn(e){return e instanceof Date&&!isNaN(e)}(e)?+e-t.now():e;o<0&&(o=0);let a=0;return t.schedule(function(){s.closed||(s.next(a++),0<=i?this.schedule(void 0,i):s.complete())},o)})}const Un={name:"test doc",pages:[{number:1,imageUrl:"pages/1.png"},{number:2,imageUrl:"pages/2.png"},{number:3,imageUrl:"pages/3.png"},{number:4,imageUrl:"pages/4.png"},{number:5,imageUrl:"pages/5.png"}]};let ne=(()=>{class e{constructor(){this.delay=2e3}getDocument(t){return(0,q.of)(Un).pipe(function Pn(e,n=vt){const t=ee(e,n);return te(()=>t)}(this.delay))}static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275prov=r.jDH({token:e,factory:e.\u0275fac})}}return e})(),ie=(()=>{class e{constructor(t){this.httpClient=t}getDocument(t){return this.httpClient.getDocument(t)}static{this.\u0275fac=function(i){return new(i||e)(r.KVO(ne))}}static{this.\u0275prov=r.jDH({token:e,factory:e.\u0275fac})}}return e})(),Gn=(()=>{class e{constructor(){this.documentPagesKeysStore=new Map,this.pagesAnnotationsIds=new Map,this.annotationsStore=new Map}saveTempAnnotation(t,i,s){return new Promise(o=>{const a=this.getTempStoreKey(t,i),l=this.getAnnotationsIds(a);l.push(s.id),this.pagesAnnotationsIds.set(a,l),this.annotationsStore.set(s.id,s),this.savePageKeyToStore(t,a,i),o()})}updateTempAnnotation(t,i,s){return new Promise(o=>{this.annotationsStore.set(s.id,s),o()})}deleteAnnotation(t){return new Promise(i=>{this.annotationsStore.delete(t),i()})}saveAnnotations(t){return new Promise(i=>{const s=[],o=this.documentPagesKeysStore.get(t);o?(Array.from(o).forEach(a=>{const l=this.getTempStoreKey(t,a),c=this.pagesAnnotationsIds.get(l);if(!c)return;const u=[];c.forEach(h=>{const f=this.annotationsStore.get(h);f&&u.push(f)}),u?.length&&s.push({page:a,annotations:u})}),i(s)):i(s)})}getTempStoreKey(t,i){return`${t}_${i}`}getAnnotationsIds(t){return this.pagesAnnotationsIds.has(t)?this.pagesAnnotationsIds.get(t):[]}savePageKeyToStore(t,i,s){const o=this.documentPagesKeysStore.get(t)??new Set;o.add(s),this.documentPagesKeysStore.set(t,o)}static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275prov=r.jDH({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})(),re=(()=>{class e{constructor(t){this.client=t}saveTempAnnotation(t,i,s){return this.client.saveTempAnnotation(t,i,s)}updateTempAnnotation(t,i,s){return this.client.updateTempAnnotation(t,i,s)}deleteTempAnnotation(t){return this.client.deleteAnnotation(t)}saveAnnotations(t){return this.client.saveAnnotations(t)}static{this.\u0275fac=function(i){return new(i||e)(r.KVO(Gn))}}static{this.\u0275prov=r.jDH({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();function Q(e,n=0){return function Ln(e){return!isNaN(parseFloat(e))&&!isNaN(Number(e))}(e)?Number(e):n}var _=d(1413),zn=d(7441),S=d(8071),se=d(6450);const Hn=["addListener","removeListener"],Xn=["addEventListener","removeEventListener"],Wn=["on","off"];function Z(e,n,t,i){if((0,S.T)(t)&&(i=t,t=void 0),i)return Z(e,n,t).pipe((0,se.I)(i));const[s,o]=function qn(e){return(0,S.T)(e.addEventListener)&&(0,S.T)(e.removeEventListener)}(e)?Xn.map(a=>l=>e[a](n,l,t)):function $n(e){return(0,S.T)(e.addListener)&&(0,S.T)(e.removeListener)}(e)?Hn.map(oe(e,n)):function Kn(e){return(0,S.T)(e.on)&&(0,S.T)(e.off)}(e)?Wn.map(oe(e,n)):[];if(!s&&(0,zn.X)(e))return(0,Jt.Z)(a=>Z(a,n,t))((0,x.Tg)(e));if(!s)throw new TypeError("Invalid event target");return new D.c(a=>{const l=(...c)=>a.next(1<c.length?c:c[0]);return s(l),()=>o(l)})}function oe(e,n){return t=>i=>e[t](n,i)}const G={schedule(e){let n=requestAnimationFrame,t=cancelAnimationFrame;const{delegate:i}=G;i&&(n=i.requestAnimationFrame,t=i.cancelAnimationFrame);const s=n(o=>{t=void 0,e(o)});return new pt.yU(()=>t?.(s))},requestAnimationFrame(...e){const{delegate:n}=G;return(n?.requestAnimationFrame||requestAnimationFrame)(...e)},cancelAnimationFrame(...e){const{delegate:n}=G;return(n?.cancelAnimationFrame||cancelAnimationFrame)(...e)},delegate:void 0},Zn=new class Qn extends _t{flush(n){this._active=!0;const t=this._scheduled;this._scheduled=void 0;const{actions:i}=this;let s;n=n||i.shift();do{if(s=n.execute(n.state,n.delay))break}while((n=i[0])&&n.id===t&&i.shift());if(this._active=!1,s){for(;(n=i[0])&&n.id===t&&i.shift();)n.unsubscribe();throw s}}}(class Yn extends mt{constructor(n,t){super(n,t),this.scheduler=n,this.work=t}requestAsyncId(n,t,i=0){return null!==i&&i>0?super.requestAsyncId(n,t,i):(n.actions.push(this),n._scheduled||(n._scheduled=G.requestAnimationFrame(()=>n.flush(void 0))))}recycleAsyncId(n,t,i=0){var s;if(null!=i?i>0:this.delay>0)return super.recycleAsyncId(n,t,i);const{actions:o}=n;null!=t&&(null===(s=o[o.length-1])||void 0===s?void 0:s.id)!==t&&(G.cancelAnimationFrame(t),n._scheduled=void 0)}});let yt,Jn=1;const J={};function ae(e){return e in J&&(delete J[e],!0)}const ti={setImmediate(e){const n=Jn++;return J[n]=!0,yt||(yt=Promise.resolve()),yt.then(()=>ae(n)&&e()),n},clearImmediate(e){ae(e)}},{setImmediate:ei,clearImmediate:ni}=ti,tt={setImmediate(...e){const{delegate:n}=tt;return(n?.setImmediate||ei)(...e)},clearImmediate(e){const{delegate:n}=tt;return(n?.clearImmediate||ni)(e)},delegate:void 0},si=new class ri extends _t{flush(n){this._active=!0;const t=this._scheduled;this._scheduled=void 0;const{actions:i}=this;let s;n=n||i.shift();do{if(s=n.execute(n.state,n.delay))break}while((n=i[0])&&n.id===t&&i.shift());if(this._active=!1,s){for(;(n=i[0])&&n.id===t&&i.shift();)n.unsubscribe();throw s}}}(class ii extends mt{constructor(n,t){super(n,t),this.scheduler=n,this.work=t}requestAsyncId(n,t,i=0){return null!==i&&i>0?super.requestAsyncId(n,t,i):(n.actions.push(this),n._scheduled||(n._scheduled=tt.setImmediate(n.flush.bind(n,void 0))))}recycleAsyncId(n,t,i=0){var s;if(null!=i?i>0:this.delay>0)return super.recycleAsyncId(n,t,i);const{actions:o}=n;null!=t&&(null===(s=o[o.length-1])||void 0===s?void 0:s.id)!==t&&(tt.clearImmediate(t),n._scheduled===t&&(n._scheduled=void 0))}});var le=d(4402),oi=d(3669);function li(e,n){return e===n}function Ct(e,n=vt){return function ci(e){return(0,U.N)((n,t)=>{let i=!1,s=null,o=null,a=!1;const l=()=>{if(o?.unsubscribe(),o=null,i){i=!1;const u=s;s=null,t.next(u)}a&&t.complete()},c=()=>{o=null,a&&t.complete()};n.subscribe((0,O._)(t,u=>{i=!0,s=u,o||(0,x.Tg)(e(u)).subscribe(o=(0,O._)(t,l,c))},()=>{a=!0,(!i||!o||o.closed)&&t.complete()}))})}(()=>ee(e,n))}var ui=d(5964),ce=d(9172),hi=d(5558);class fi extends _.B{constructor(n=1/0,t=1/0,i=gt){super(),this._bufferSize=n,this._windowTime=t,this._timestampProvider=i,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=t===1/0,this._bufferSize=Math.max(1,n),this._windowTime=Math.max(1,t)}next(n){const{isStopped:t,_buffer:i,_infiniteTimeWindow:s,_timestampProvider:o,_windowTime:a}=this;t||(i.push(n),!s&&i.push(o.now()+a)),this._trimBuffer(),super.next(n)}_subscribe(n){this._throwIfClosed(),this._trimBuffer();const t=this._innerSubscribe(n),{_infiniteTimeWindow:i,_buffer:s}=this,o=s.slice();for(let a=0;a<o.length&&!n.closed;a+=i?1:2)n.next(o[a]);return this._checkFinalizedStatuses(n),t}_trimBuffer(){const{_bufferSize:n,_timestampProvider:t,_buffer:i,_infiniteTimeWindow:s}=this,o=(s?1:2)*n;if(n<1/0&&o<i.length&&i.splice(0,i.length-o),!s){const a=t.now();let l=0;for(let c=1;c<i.length&&i[c]<=a;c+=2)l=c;l&&i.splice(0,l+1)}}}var ue=d(7707);function Vt(e,n,...t){if(!0===n)return void e();if(!1===n)return;const i=new ue.Ms({next:()=>{i.unsubscribe(),e()}});return(0,x.Tg)(n(...t)).subscribe(i)}let wt;try{wt=typeof Intl<"u"&&Intl.v8BreakIterator}catch{wt=!1}let bt=(()=>{class e{constructor(t){this._platformId=t,this.isBrowser=this._platformId?(0,g.UE)(this._platformId):"object"==typeof document&&!!document,this.EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent),this.TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent),this.BLINK=this.isBrowser&&!(!window.chrome&&!wt)&&typeof CSS<"u"&&!this.EDGE&&!this.TRIDENT,this.WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT,this.IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window),this.FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent),this.ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT,this.SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT}static{this.\u0275fac=function(i){return new(i||e)(r.KVO(r.Agw))}}static{this.\u0275prov=r.jDH({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();var v=function(e){return e[e.NORMAL=0]="NORMAL",e[e.NEGATED=1]="NEGATED",e[e.INVERTED=2]="INVERTED",e}(v||{});let et,A;function j(){if("object"!=typeof document||!document)return v.NORMAL;if(null==et){const e=document.createElement("div"),n=e.style;e.dir="rtl",n.width="1px",n.overflow="auto",n.visibility="hidden",n.pointerEvents="none",n.position="absolute";const t=document.createElement("div"),i=t.style;i.width="2px",i.height="1px",e.appendChild(t),document.body.appendChild(e),et=v.NORMAL,0===e.scrollLeft&&(e.scrollLeft=1,et=0===e.scrollLeft?v.NEGATED:v.INVERTED),e.remove()}return et}const yi=new r.nKC("cdk-dir-doc",{providedIn:"root",factory:function Ci(){return(0,r.WQX)(g.qQ)}}),Vi=/^(ar|ckb|dv|he|iw|fa|nqo|ps|sd|ug|ur|yi|.*[-_](Adlm|Arab|Hebr|Nkoo|Rohg|Thaa))(?!.*[-_](Latn|Cyrl)($|-|_))($|-|_)/i;let St=(()=>{class e{constructor(t){this.value="ltr",this.change=new r.bkB,t&&(this.value=function wi(e){const n=e?.toLowerCase()||"";return"auto"===n&&typeof navigator<"u"&&navigator?.language?Vi.test(navigator.language)?"rtl":"ltr":"rtl"===n?"rtl":"ltr"}((t.body?t.body.dir:null)||(t.documentElement?t.documentElement.dir:null)||"ltr"))}ngOnDestroy(){this.change.complete()}static{this.\u0275fac=function(i){return new(i||e)(r.KVO(yi,8))}}static{this.\u0275prov=r.jDH({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})(),he=(()=>{class e{static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275mod=r.$C({type:e})}static{this.\u0275inj=r.G2t({})}}return e})();var bi=d(17);class Di{}class Ai extends Di{constructor(n){super(),this._data=n}connect(){return(0,le.A)(this._data)?this._data:(0,q.of)(this._data)}disconnect(){}}var C=function(e){return e[e.REPLACED=0]="REPLACED",e[e.INSERTED=1]="INSERTED",e[e.MOVED=2]="MOVED",e[e.REMOVED=3]="REMOVED",e}(C||{});const fe=new r.nKC("_ViewRepeater");class Ei{constructor(){this.viewCacheSize=20,this._viewCache=[]}applyChanges(n,t,i,s,o){n.forEachOperation((a,l,c)=>{let u,h;null==a.previousIndex?(u=this._insertView(()=>i(a,l,c),c,t,s(a)),h=u?C.INSERTED:C.REPLACED):null==c?(this._detachAndCacheView(l,t),h=C.REMOVED):(u=this._moveView(l,c,t,s(a)),h=C.MOVED),o&&o({context:u?.context,operation:h,record:a})})}detach(){for(const n of this._viewCache)n.destroy();this._viewCache=[]}_insertView(n,t,i,s){const o=this._insertViewFromCache(t,i);if(o)return void(o.context.$implicit=s);const a=n();return i.createEmbeddedView(a.templateRef,a.context,a.index)}_detachAndCacheView(n,t){const i=t.detach(n);this._maybeCacheView(i,t)}_moveView(n,t,i,s){const o=i.get(n);return i.move(o,t),o.context.$implicit=s,o}_maybeCacheView(n,t){if(this._viewCache.length<this.viewCacheSize)this._viewCache.push(n);else{const i=t.indexOf(n);-1===i?n.destroy():t.remove(i)}}_insertViewFromCache(n,t){const i=this._viewCache.pop();return i&&t.insert(i,n),i||null}}const Mi=["contentWrapper"],Fi=["*"],pe=new r.nKC("VIRTUAL_SCROLL_STRATEGY");class Oi{constructor(n,t,i){this._scrolledIndexChange=new _.B,this.scrolledIndexChange=this._scrolledIndexChange.pipe(function ai(e,n=oi.D){return e=e??li,(0,U.N)((t,i)=>{let s,o=!0;t.subscribe((0,O._)(i,a=>{const l=n(a);(o||!e(s,l))&&(o=!1,s=l,i.next(a))}))})}()),this._viewport=null,this._itemSize=n,this._minBufferPx=t,this._maxBufferPx=i}attach(n){this._viewport=n,this._updateTotalContentSize(),this._updateRenderedRange()}detach(){this._scrolledIndexChange.complete(),this._viewport=null}updateItemAndBufferSize(n,t,i){this._itemSize=n,this._minBufferPx=t,this._maxBufferPx=i,this._updateTotalContentSize(),this._updateRenderedRange()}onContentScrolled(){this._updateRenderedRange()}onDataLengthChanged(){this._updateTotalContentSize(),this._updateRenderedRange()}onContentRendered(){}onRenderedOffsetChanged(){}scrollToIndex(n,t){this._viewport&&this._viewport.scrollToOffset(n*this._itemSize,t)}_updateTotalContentSize(){this._viewport&&this._viewport.setTotalContentSize(this._viewport.getDataLength()*this._itemSize)}_updateRenderedRange(){if(!this._viewport)return;const n=this._viewport.getRenderedRange(),t={start:n.start,end:n.end},i=this._viewport.getViewportSize(),s=this._viewport.getDataLength();let o=this._viewport.measureScrollOffset(),a=this._itemSize>0?o/this._itemSize:0;if(t.end>s){const c=Math.ceil(i/this._itemSize),u=Math.max(0,Math.min(a,s-c));a!=u&&(a=u,o=u*this._itemSize,t.start=Math.floor(a)),t.end=Math.max(0,Math.min(s,t.start+c))}const l=o-t.start*this._itemSize;if(l<this._minBufferPx&&0!=t.start){const c=Math.ceil((this._maxBufferPx-l)/this._itemSize);t.start=Math.max(0,t.start-c),t.end=Math.min(s,Math.ceil(a+(i+this._minBufferPx)/this._itemSize))}else{const c=t.end*this._itemSize-(o+i);if(c<this._minBufferPx&&t.end!=s){const u=Math.ceil((this._maxBufferPx-c)/this._itemSize);u>0&&(t.end=Math.min(s,t.end+u),t.start=Math.max(0,Math.floor(a-this._minBufferPx/this._itemSize)))}}this._viewport.setRenderedRange(t),this._viewport.setRenderedContentOffset(this._itemSize*t.start),this._scrolledIndexChange.next(Math.floor(a))}}function xi(e){return e._scrollStrategy}let Ri=(()=>{class e{constructor(){this._itemSize=20,this._minBufferPx=100,this._maxBufferPx=200,this._scrollStrategy=new Oi(this.itemSize,this.minBufferPx,this.maxBufferPx)}get itemSize(){return this._itemSize}set itemSize(t){this._itemSize=Q(t)}get minBufferPx(){return this._minBufferPx}set minBufferPx(t){this._minBufferPx=Q(t)}get maxBufferPx(){return this._maxBufferPx}set maxBufferPx(t){this._maxBufferPx=Q(t)}ngOnChanges(){this._scrollStrategy.updateItemAndBufferSize(this.itemSize,this.minBufferPx,this.maxBufferPx)}static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275dir=r.FsC({type:e,selectors:[["cdk-virtual-scroll-viewport","itemSize",""]],inputs:{itemSize:"itemSize",minBufferPx:"minBufferPx",maxBufferPx:"maxBufferPx"},standalone:!0,features:[r.Jv_([{provide:pe,useFactory:xi,deps:[(0,r.Rfq)(()=>e)]}]),r.OA$]})}}return e})(),At=(()=>{class e{constructor(t,i,s){this._ngZone=t,this._platform=i,this._scrolled=new _.B,this._globalSubscription=null,this._scrolledCount=0,this.scrollContainers=new Map,this._document=s}register(t){this.scrollContainers.has(t)||this.scrollContainers.set(t,t.elementScrolled().subscribe(()=>this._scrolled.next(t)))}deregister(t){const i=this.scrollContainers.get(t);i&&(i.unsubscribe(),this.scrollContainers.delete(t))}scrolled(t=20){return this._platform.isBrowser?new D.c(i=>{this._globalSubscription||this._addGlobalListener();const s=t>0?this._scrolled.pipe(Ct(t)).subscribe(i):this._scrolled.subscribe(i);return this._scrolledCount++,()=>{s.unsubscribe(),this._scrolledCount--,this._scrolledCount||this._removeGlobalListener()}}):(0,q.of)()}ngOnDestroy(){this._removeGlobalListener(),this.scrollContainers.forEach((t,i)=>this.deregister(i)),this._scrolled.complete()}ancestorScrolled(t,i){const s=this.getAncestorScrollContainers(t);return this.scrolled(i).pipe((0,ui.p)(o=>!o||s.indexOf(o)>-1))}getAncestorScrollContainers(t){const i=[];return this.scrollContainers.forEach((s,o)=>{this._scrollableContainsElement(o,t)&&i.push(o)}),i}_getWindow(){return this._document.defaultView||window}_scrollableContainsElement(t,i){let s=function jn(e){return e instanceof r.aKT?e.nativeElement:e}(i),o=t.getElementRef().nativeElement;do{if(s==o)return!0}while(s=s.parentElement);return!1}_addGlobalListener(){this._globalSubscription=this._ngZone.runOutsideAngular(()=>Z(this._getWindow().document,"scroll").subscribe(()=>this._scrolled.next()))}_removeGlobalListener(){this._globalSubscription&&(this._globalSubscription.unsubscribe(),this._globalSubscription=null)}static{this.\u0275fac=function(i){return new(i||e)(r.KVO(r.SKi),r.KVO(bt),r.KVO(g.qQ,8))}}static{this.\u0275prov=r.jDH({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})(),me=(()=>{class e{constructor(t,i,s,o){this.elementRef=t,this.scrollDispatcher=i,this.ngZone=s,this.dir=o,this._destroyed=new _.B,this._elementScrolled=new D.c(a=>this.ngZone.runOutsideAngular(()=>Z(this.elementRef.nativeElement,"scroll").pipe((0,N.Q)(this._destroyed)).subscribe(a)))}ngOnInit(){this.scrollDispatcher.register(this)}ngOnDestroy(){this.scrollDispatcher.deregister(this),this._destroyed.next(),this._destroyed.complete()}elementScrolled(){return this._elementScrolled}getElementRef(){return this.elementRef}scrollTo(t){const i=this.elementRef.nativeElement,s=this.dir&&"rtl"==this.dir.value;null==t.left&&(t.left=s?t.end:t.start),null==t.right&&(t.right=s?t.start:t.end),null!=t.bottom&&(t.top=i.scrollHeight-i.clientHeight-t.bottom),s&&j()!=v.NORMAL?(null!=t.left&&(t.right=i.scrollWidth-i.clientWidth-t.left),j()==v.INVERTED?t.left=t.right:j()==v.NEGATED&&(t.left=t.right?-t.right:t.right)):null!=t.right&&(t.left=i.scrollWidth-i.clientWidth-t.right),this._applyScrollToOptions(t)}_applyScrollToOptions(t){const i=this.elementRef.nativeElement;!function _i(){if(null==A){if("object"!=typeof document||!document||"function"!=typeof Element||!Element)return A=!1,A;if("scrollBehavior"in document.documentElement.style)A=!0;else{const e=Element.prototype.scrollTo;A=!!e&&!/\{\s*\[native code\]\s*\}/.test(e.toString())}}return A}()?(null!=t.top&&(i.scrollTop=t.top),null!=t.left&&(i.scrollLeft=t.left)):i.scrollTo(t)}measureScrollOffset(t){const i="left",s="right",o=this.elementRef.nativeElement;if("top"==t)return o.scrollTop;if("bottom"==t)return o.scrollHeight-o.clientHeight-o.scrollTop;const a=this.dir&&"rtl"==this.dir.value;return"start"==t?t=a?s:i:"end"==t&&(t=a?i:s),a&&j()==v.INVERTED?t==i?o.scrollWidth-o.clientWidth-o.scrollLeft:o.scrollLeft:a&&j()==v.NEGATED?t==i?o.scrollLeft+o.scrollWidth-o.clientWidth:-o.scrollLeft:t==i?o.scrollLeft:o.scrollWidth-o.clientWidth-o.scrollLeft}static{this.\u0275fac=function(i){return new(i||e)(r.rXU(r.aKT),r.rXU(At),r.rXU(r.SKi),r.rXU(St,8))}}static{this.\u0275dir=r.FsC({type:e,selectors:[["","cdk-scrollable",""],["","cdkScrollable",""]],standalone:!0})}}return e})(),Ti=(()=>{class e{constructor(t,i,s){this._platform=t,this._change=new _.B,this._changeListener=o=>{this._change.next(o)},this._document=s,i.runOutsideAngular(()=>{if(t.isBrowser){const o=this._getWindow();o.addEventListener("resize",this._changeListener),o.addEventListener("orientationchange",this._changeListener)}this.change().subscribe(()=>this._viewportSize=null)})}ngOnDestroy(){if(this._platform.isBrowser){const t=this._getWindow();t.removeEventListener("resize",this._changeListener),t.removeEventListener("orientationchange",this._changeListener)}this._change.complete()}getViewportSize(){this._viewportSize||this._updateViewportSize();const t={width:this._viewportSize.width,height:this._viewportSize.height};return this._platform.isBrowser||(this._viewportSize=null),t}getViewportRect(){const t=this.getViewportScrollPosition(),{width:i,height:s}=this.getViewportSize();return{top:t.top,left:t.left,bottom:t.top+s,right:t.left+i,height:s,width:i}}getViewportScrollPosition(){if(!this._platform.isBrowser)return{top:0,left:0};const t=this._document,i=this._getWindow(),s=t.documentElement,o=s.getBoundingClientRect();return{top:-o.top||t.body.scrollTop||i.scrollY||s.scrollTop||0,left:-o.left||t.body.scrollLeft||i.scrollX||s.scrollLeft||0}}change(t=20){return t>0?this._change.pipe(Ct(t)):this._change}_getWindow(){return this._document.defaultView||window}_updateViewportSize(){const t=this._getWindow();this._viewportSize=this._platform.isBrowser?{width:t.innerWidth,height:t.innerHeight}:{width:0,height:0}}static{this.\u0275fac=function(i){return new(i||e)(r.KVO(bt),r.KVO(r.SKi),r.KVO(g.qQ,8))}}static{this.\u0275prov=r.jDH({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();const ge=new r.nKC("VIRTUAL_SCROLLABLE");let Ni=(()=>{class e extends me{constructor(t,i,s,o){super(t,i,s,o)}measureViewportSize(t){const i=this.elementRef.nativeElement;return"horizontal"===t?i.clientWidth:i.clientHeight}static{this.\u0275fac=function(i){return new(i||e)(r.rXU(r.aKT),r.rXU(At),r.rXU(r.SKi),r.rXU(St,8))}}static{this.\u0275dir=r.FsC({type:e,features:[r.Vt3]})}}return e})();const Pi=typeof requestAnimationFrame<"u"?Zn:si;let _e=(()=>{class e extends Ni{get orientation(){return this._orientation}set orientation(t){this._orientation!==t&&(this._orientation=t,this._calculateSpacerSize())}constructor(t,i,s,o,a,l,c,u){super(t,l,s,a),this.elementRef=t,this._changeDetectorRef=i,this._scrollStrategy=o,this.scrollable=u,this._platform=(0,r.WQX)(bt),this._detachedSubject=new _.B,this._renderedRangeSubject=new _.B,this._orientation="vertical",this.appendOnly=!1,this.scrolledIndexChange=new D.c(h=>this._scrollStrategy.scrolledIndexChange.subscribe(f=>Promise.resolve().then(()=>this.ngZone.run(()=>h.next(f))))),this.renderedRangeStream=this._renderedRangeSubject,this._totalContentSize=0,this._totalContentWidth="",this._totalContentHeight="",this._renderedRange={start:0,end:0},this._dataLength=0,this._viewportSize=0,this._renderedContentOffset=0,this._renderedContentOffsetNeedsRewrite=!1,this._isChangeDetectionPending=!1,this._runAfterChangeDetection=[],this._viewportChanges=pt.yU.EMPTY,this._viewportChanges=c.change().subscribe(()=>{this.checkViewportSize()}),this.scrollable||(this.elementRef.nativeElement.classList.add("cdk-virtual-scrollable"),this.scrollable=this)}ngOnInit(){this._platform.isBrowser&&(this.scrollable===this&&super.ngOnInit(),this.ngZone.runOutsideAngular(()=>Promise.resolve().then(()=>{this._measureViewportSize(),this._scrollStrategy.attach(this),this.scrollable.elementScrolled().pipe((0,ce.Z)(null),Ct(0,Pi),(0,N.Q)(this._destroyed)).subscribe(()=>this._scrollStrategy.onContentScrolled()),this._markChangeDetectionNeeded()})))}ngOnDestroy(){this.detach(),this._scrollStrategy.detach(),this._renderedRangeSubject.complete(),this._detachedSubject.complete(),this._viewportChanges.unsubscribe(),super.ngOnDestroy()}attach(t){this.ngZone.runOutsideAngular(()=>{this._forOf=t,this._forOf.dataStream.pipe((0,N.Q)(this._detachedSubject)).subscribe(i=>{const s=i.length;s!==this._dataLength&&(this._dataLength=s,this._scrollStrategy.onDataLengthChanged()),this._doChangeDetection()})})}detach(){this._forOf=null,this._detachedSubject.next()}getDataLength(){return this._dataLength}getViewportSize(){return this._viewportSize}getRenderedRange(){return this._renderedRange}measureBoundingClientRectWithScrollOffset(t){return this.getElementRef().nativeElement.getBoundingClientRect()[t]}setTotalContentSize(t){this._totalContentSize!==t&&(this._totalContentSize=t,this._calculateSpacerSize(),this._markChangeDetectionNeeded())}setRenderedRange(t){(function Bi(e,n){return e.start==n.start&&e.end==n.end})(this._renderedRange,t)||(this.appendOnly&&(t={start:0,end:Math.max(this._renderedRange.end,t.end)}),this._renderedRangeSubject.next(this._renderedRange=t),this._markChangeDetectionNeeded(()=>this._scrollStrategy.onContentRendered()))}getOffsetToRenderedContentStart(){return this._renderedContentOffsetNeedsRewrite?null:this._renderedContentOffset}setRenderedContentOffset(t,i="to-start"){t=this.appendOnly&&"to-start"===i?0:t;const o="horizontal"==this.orientation,a=o?"X":"Y";let c=`translate${a}(${Number((o&&this.dir&&"rtl"==this.dir.value?-1:1)*t)}px)`;this._renderedContentOffset=t,"to-end"===i&&(c+=` translate${a}(-100%)`,this._renderedContentOffsetNeedsRewrite=!0),this._renderedContentTransform!=c&&(this._renderedContentTransform=c,this._markChangeDetectionNeeded(()=>{this._renderedContentOffsetNeedsRewrite?(this._renderedContentOffset-=this.measureRenderedContentSize(),this._renderedContentOffsetNeedsRewrite=!1,this.setRenderedContentOffset(this._renderedContentOffset)):this._scrollStrategy.onRenderedOffsetChanged()}))}scrollToOffset(t,i="auto"){const s={behavior:i};"horizontal"===this.orientation?s.start=t:s.top=t,this.scrollable.scrollTo(s)}scrollToIndex(t,i="auto"){this._scrollStrategy.scrollToIndex(t,i)}measureScrollOffset(t){let i;return i=this.scrollable==this?s=>super.measureScrollOffset(s):s=>this.scrollable.measureScrollOffset(s),Math.max(0,i(t??("horizontal"===this.orientation?"start":"top"))-this.measureViewportOffset())}measureViewportOffset(t){let i;const s="left",o="right",a="rtl"==this.dir?.value;i="start"==t?a?o:s:"end"==t?a?s:o:t||("horizontal"===this.orientation?"left":"top");const l=this.scrollable.measureBoundingClientRectWithScrollOffset(i);return this.elementRef.nativeElement.getBoundingClientRect()[i]-l}measureRenderedContentSize(){const t=this._contentWrapper.nativeElement;return"horizontal"===this.orientation?t.offsetWidth:t.offsetHeight}measureRangeSize(t){return this._forOf?this._forOf.measureRangeSize(t,this.orientation):0}checkViewportSize(){this._measureViewportSize(),this._scrollStrategy.onDataLengthChanged()}_measureViewportSize(){this._viewportSize=this.scrollable.measureViewportSize(this.orientation)}_markChangeDetectionNeeded(t){t&&this._runAfterChangeDetection.push(t),this._isChangeDetectionPending||(this._isChangeDetectionPending=!0,this.ngZone.runOutsideAngular(()=>Promise.resolve().then(()=>{this._doChangeDetection()})))}_doChangeDetection(){this._isChangeDetectionPending=!1,this._contentWrapper.nativeElement.style.transform=this._renderedContentTransform,this.ngZone.run(()=>this._changeDetectorRef.markForCheck());const t=this._runAfterChangeDetection;this._runAfterChangeDetection=[];for(const i of t)i()}_calculateSpacerSize(){this._totalContentHeight="horizontal"===this.orientation?"":`${this._totalContentSize}px`,this._totalContentWidth="horizontal"===this.orientation?`${this._totalContentSize}px`:""}static{this.\u0275fac=function(i){return new(i||e)(r.rXU(r.aKT),r.rXU(r.gRc),r.rXU(r.SKi),r.rXU(pe,8),r.rXU(St,8),r.rXU(At),r.rXU(Ti),r.rXU(ge,8))}}static{this.\u0275cmp=r.VBU({type:e,selectors:[["cdk-virtual-scroll-viewport"]],viewQuery:function(i,s){if(1&i&&r.GBs(Mi,7),2&i){let o;r.mGM(o=r.lsd())&&(s._contentWrapper=o.first)}},hostAttrs:[1,"cdk-virtual-scroll-viewport"],hostVars:4,hostBindings:function(i,s){2&i&&r.AVh("cdk-virtual-scroll-orientation-horizontal","horizontal"===s.orientation)("cdk-virtual-scroll-orientation-vertical","horizontal"!==s.orientation)},inputs:{orientation:"orientation",appendOnly:[r.Mj6.HasDecoratorInputTransform,"appendOnly","appendOnly",r.L39]},outputs:{scrolledIndexChange:"scrolledIndexChange"},standalone:!0,features:[r.Jv_([{provide:me,useFactory:(t,i)=>t||i,deps:[[new r.Xx1,new r.y_5(ge)],e]}]),r.GFd,r.Vt3,r.aNF],ngContentSelectors:Fi,decls:4,vars:4,consts:[["contentWrapper",""],[1,"cdk-virtual-scroll-content-wrapper"],[1,"cdk-virtual-scroll-spacer"]],template:function(i,s){1&i&&(r.NAR(),r.j41(0,"div",1,0),r.SdG(2),r.k0s(),r.nrm(3,"div",2)),2&i&&(r.R7$(3),r.xc7("width",s._totalContentWidth)("height",s._totalContentHeight))},styles:["cdk-virtual-scroll-viewport{display:block;position:relative;transform:translateZ(0)}.cdk-virtual-scrollable{overflow:auto;will-change:scroll-position;contain:strict;-webkit-overflow-scrolling:touch}.cdk-virtual-scroll-content-wrapper{position:absolute;top:0;left:0;contain:content}[dir=rtl] .cdk-virtual-scroll-content-wrapper{right:0;left:auto}.cdk-virtual-scroll-orientation-horizontal .cdk-virtual-scroll-content-wrapper{min-height:100%}.cdk-virtual-scroll-orientation-horizontal .cdk-virtual-scroll-content-wrapper>dl:not([cdkVirtualFor]),.cdk-virtual-scroll-orientation-horizontal .cdk-virtual-scroll-content-wrapper>ol:not([cdkVirtualFor]),.cdk-virtual-scroll-orientation-horizontal .cdk-virtual-scroll-content-wrapper>table:not([cdkVirtualFor]),.cdk-virtual-scroll-orientation-horizontal .cdk-virtual-scroll-content-wrapper>ul:not([cdkVirtualFor]){padding-left:0;padding-right:0;margin-left:0;margin-right:0;border-left-width:0;border-right-width:0;outline:none}.cdk-virtual-scroll-orientation-vertical .cdk-virtual-scroll-content-wrapper{min-width:100%}.cdk-virtual-scroll-orientation-vertical .cdk-virtual-scroll-content-wrapper>dl:not([cdkVirtualFor]),.cdk-virtual-scroll-orientation-vertical .cdk-virtual-scroll-content-wrapper>ol:not([cdkVirtualFor]),.cdk-virtual-scroll-orientation-vertical .cdk-virtual-scroll-content-wrapper>table:not([cdkVirtualFor]),.cdk-virtual-scroll-orientation-vertical .cdk-virtual-scroll-content-wrapper>ul:not([cdkVirtualFor]){padding-top:0;padding-bottom:0;margin-top:0;margin-bottom:0;border-top-width:0;border-bottom-width:0;outline:none}.cdk-virtual-scroll-spacer{height:1px;transform-origin:0 0;flex:0 0 auto}[dir=rtl] .cdk-virtual-scroll-spacer{transform-origin:100% 0}"],encapsulation:2,changeDetection:0})}}return e})();function ve(e,n,t){if(!t.getBoundingClientRect)return 0;const s=t.getBoundingClientRect();return"horizontal"===e?"start"===n?s.left:s.right:"start"===n?s.top:s.bottom}let Ui=(()=>{class e{get cdkVirtualForOf(){return this._cdkVirtualForOf}set cdkVirtualForOf(t){this._cdkVirtualForOf=t,function Si(e){return e&&"function"==typeof e.connect&&!(e instanceof bi.G)}(t)?this._dataSourceChanges.next(t):this._dataSourceChanges.next(new Ai((0,le.A)(t)?t:Array.from(t||[])))}get cdkVirtualForTrackBy(){return this._cdkVirtualForTrackBy}set cdkVirtualForTrackBy(t){this._needsUpdate=!0,this._cdkVirtualForTrackBy=t?(i,s)=>t(i+(this._renderedRange?this._renderedRange.start:0),s):void 0}set cdkVirtualForTemplate(t){t&&(this._needsUpdate=!0,this._template=t)}get cdkVirtualForTemplateCacheSize(){return this._viewRepeater.viewCacheSize}set cdkVirtualForTemplateCacheSize(t){this._viewRepeater.viewCacheSize=Q(t)}constructor(t,i,s,o,a,l){this._viewContainerRef=t,this._template=i,this._differs=s,this._viewRepeater=o,this._viewport=a,this.viewChange=new _.B,this._dataSourceChanges=new _.B,this.dataStream=this._dataSourceChanges.pipe((0,ce.Z)(null),function di(){return(0,U.N)((e,n)=>{let t,i=!1;e.subscribe((0,O._)(n,s=>{const o=t;t=s,i&&n.next([o,s]),i=!0}))})}(),(0,hi.n)(([c,u])=>this._changeDataSource(c,u)),function mi(e,n,t){let i,s=!1;return e&&"object"==typeof e?({bufferSize:i=1/0,windowTime:n=1/0,refCount:s=!1,scheduler:t}=e):i=e??1/0,function pi(e={}){const{connector:n=(()=>new _.B),resetOnError:t=!0,resetOnComplete:i=!0,resetOnRefCountZero:s=!0}=e;return o=>{let a,l,c,u=0,h=!1,f=!1;const k=()=>{l?.unsubscribe(),l=void 0},Yt=()=>{k(),a=c=void 0,h=f=!1},us=()=>{const K=a;Yt(),K?.unsubscribe()};return(0,U.N)((K,Dn)=>{u++,!f&&!h&&k();const ht=c=c??n();Dn.add(()=>{u--,0===u&&!f&&!h&&(l=Vt(us,s))}),ht.subscribe(Dn),!a&&u>0&&(a=new ue.Ms({next:ft=>ht.next(ft),error:ft=>{f=!0,k(),l=Vt(Yt,t,ft),ht.error(ft)},complete:()=>{h=!0,k(),l=Vt(Yt,i),ht.complete()}}),(0,x.Tg)(K).subscribe(a))})(o)}}({connector:()=>new fi(i,n,t),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:s})}(1)),this._differ=null,this._needsUpdate=!1,this._destroyed=new _.B,this.dataStream.subscribe(c=>{this._data=c,this._onRenderedDataChange()}),this._viewport.renderedRangeStream.pipe((0,N.Q)(this._destroyed)).subscribe(c=>{this._renderedRange=c,this.viewChange.observers.length&&l.run(()=>this.viewChange.next(this._renderedRange)),this._onRenderedDataChange()}),this._viewport.attach(this)}measureRangeSize(t,i){if(t.start>=t.end)return 0;const s=t.start-this._renderedRange.start,o=t.end-t.start;let a,l;for(let c=0;c<o;c++){const u=this._viewContainerRef.get(c+s);if(u&&u.rootNodes.length){a=l=u.rootNodes[0];break}}for(let c=o-1;c>-1;c--){const u=this._viewContainerRef.get(c+s);if(u&&u.rootNodes.length){l=u.rootNodes[u.rootNodes.length-1];break}}return a&&l?ve(i,"end",l)-ve(i,"start",a):0}ngDoCheck(){if(this._differ&&this._needsUpdate){const t=this._differ.diff(this._renderedItems);t?this._applyChanges(t):this._updateContext(),this._needsUpdate=!1}}ngOnDestroy(){this._viewport.detach(),this._dataSourceChanges.next(void 0),this._dataSourceChanges.complete(),this.viewChange.complete(),this._destroyed.next(),this._destroyed.complete(),this._viewRepeater.detach()}_onRenderedDataChange(){this._renderedRange&&(this._renderedItems=this._data.slice(this._renderedRange.start,this._renderedRange.end),this._differ||(this._differ=this._differs.find(this._renderedItems).create((t,i)=>this.cdkVirtualForTrackBy?this.cdkVirtualForTrackBy(t,i):i)),this._needsUpdate=!0)}_changeDataSource(t,i){return t&&t.disconnect(this),this._needsUpdate=!0,i?i.connect(this):(0,q.of)()}_updateContext(){const t=this._data.length;let i=this._viewContainerRef.length;for(;i--;){const s=this._viewContainerRef.get(i);s.context.index=this._renderedRange.start+i,s.context.count=t,this._updateComputedContextProperties(s.context),s.detectChanges()}}_applyChanges(t){this._viewRepeater.applyChanges(t,this._viewContainerRef,(o,a,l)=>this._getEmbeddedViewArgs(o,l),o=>o.item),t.forEachIdentityChange(o=>{this._viewContainerRef.get(o.currentIndex).context.$implicit=o.item});const i=this._data.length;let s=this._viewContainerRef.length;for(;s--;){const o=this._viewContainerRef.get(s);o.context.index=this._renderedRange.start+s,o.context.count=i,this._updateComputedContextProperties(o.context)}}_updateComputedContextProperties(t){t.first=0===t.index,t.last=t.index===t.count-1,t.even=t.index%2==0,t.odd=!t.even}_getEmbeddedViewArgs(t,i){return{templateRef:this._template,context:{$implicit:t.item,cdkVirtualForOf:this._cdkVirtualForOf,index:-1,count:-1,first:!1,last:!1,odd:!1,even:!1},index:i}}static{this.\u0275fac=function(i){return new(i||e)(r.rXU(r.c1b),r.rXU(r.C4Q),r.rXU(r._q3),r.rXU(fe),r.rXU(_e,4),r.rXU(r.SKi))}}static{this.\u0275dir=r.FsC({type:e,selectors:[["","cdkVirtualFor","","cdkVirtualForOf",""]],inputs:{cdkVirtualForOf:"cdkVirtualForOf",cdkVirtualForTrackBy:"cdkVirtualForTrackBy",cdkVirtualForTemplate:"cdkVirtualForTemplate",cdkVirtualForTemplateCacheSize:"cdkVirtualForTemplateCacheSize"},standalone:!0,features:[r.Jv_([{provide:fe,useClass:Ei}])]})}}return e})(),ye=(()=>{class e{static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275mod=r.$C({type:e})}static{this.\u0275inj=r.G2t({})}}return e})(),Gi=(()=>{class e{static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275mod=r.$C({type:e})}static{this.\u0275inj=r.G2t({imports:[he,ye,he,ye]})}}return e})();var Li=d(6648),ji=d(3073),zi=d(9326),Hi=d(8496),Wi=d(6354);let Ce=(()=>{class e{constructor(t,i){this._renderer=t,this._elementRef=i,this.onChange=s=>{},this.onTouched=()=>{}}setProperty(t,i){this._renderer.setProperty(this._elementRef.nativeElement,t,i)}registerOnTouched(t){this.onTouched=t}registerOnChange(t){this.onChange=t}setDisabledState(t){this.setProperty("disabled",t)}static{this.\u0275fac=function(i){return new(i||e)(r.rXU(r.sFG),r.rXU(r.aKT))}}static{this.\u0275dir=r.FsC({type:e})}}return e})(),E=(()=>{class e extends Ce{static{this.\u0275fac=(()=>{let t;return function(s){return(t||(t=r.xGo(e)))(s||e)}})()}static{this.\u0275dir=r.FsC({type:e,features:[r.Vt3]})}}return e})();const y=new r.nKC(""),Ki={provide:y,useExisting:(0,r.Rfq)(()=>nt),multi:!0},Yi=new r.nKC("");let nt=(()=>{class e extends Ce{constructor(t,i,s){super(t,i),this._compositionMode=s,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function qi(){const e=(0,g.QT)()?(0,g.QT)().getUserAgent():"";return/android (\d+)/.test(e.toLowerCase())}())}writeValue(t){this.setProperty("value",t??"")}_handleInput(t){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(t)}_compositionStart(){this._composing=!0}_compositionEnd(t){this._composing=!1,this._compositionMode&&this.onChange(t)}static{this.\u0275fac=function(i){return new(i||e)(r.rXU(r.sFG),r.rXU(r.aKT),r.rXU(Yi,8))}}static{this.\u0275dir=r.FsC({type:e,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(i,s){1&i&&r.bIt("input",function(a){return s._handleInput(a.target.value)})("blur",function(){return s.onTouched()})("compositionstart",function(){return s._compositionStart()})("compositionend",function(a){return s._compositionEnd(a.target.value)})},features:[r.Jv_([Ki]),r.Vt3]})}}return e})();const p=new r.nKC(""),w=new r.nKC("");function xe(e){return null!=e}function Re(e){return(0,r.jNT)(e)?(0,Li.H)(e):e}function Ie(e){let n={};return e.forEach(t=>{n=null!=t?{...n,...t}:n}),0===Object.keys(n).length?null:n}function ke(e,n){return n.map(t=>t(e))}function Te(e){return e.map(n=>function Zi(e){return!e.validate}(n)?n:t=>n.validate(t))}function Et(e){return null!=e?function Ne(e){if(!e)return null;const n=e.filter(xe);return 0==n.length?null:function(t){return Ie(ke(t,n))}}(Te(e)):null}function Mt(e){return null!=e?function Be(e){if(!e)return null;const n=e.filter(xe);return 0==n.length?null:function(t){return function Xi(...e){const n=(0,zi.ms)(e),{args:t,keys:i}=(0,ji.D)(e),s=new D.c(o=>{const{length:a}=t;if(!a)return void o.complete();const l=new Array(a);let c=a,u=a;for(let h=0;h<a;h++){let f=!1;(0,x.Tg)(t[h]).subscribe((0,O._)(o,k=>{f||(f=!0,u--),l[h]=k},()=>c--,void 0,()=>{(!c||!f)&&(u||o.next(i?(0,Hi.e)(i,l):l),o.complete())}))}});return n?s.pipe((0,se.I)(n)):s}(ke(t,n).map(Re)).pipe((0,Wi.T)(Ie))}}(Te(e)):null}function Pe(e,n){return null===e?[n]:Array.isArray(e)?[...e,n]:[e,n]}function Ue(e){return e._rawValidators}function Ge(e){return e._rawAsyncValidators}function Ft(e){return e?Array.isArray(e)?e:[e]:[]}function rt(e,n){return Array.isArray(e)?e.includes(n):e===n}function Le(e,n){const t=Ft(n);return Ft(e).forEach(s=>{rt(t,s)||t.push(s)}),t}function je(e,n){return Ft(n).filter(t=>!rt(e,t))}class ze{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(n){this._rawValidators=n||[],this._composedValidatorFn=Et(this._rawValidators)}_setAsyncValidators(n){this._rawAsyncValidators=n||[],this._composedAsyncValidatorFn=Mt(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(n){this._onDestroyCallbacks.push(n)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(n=>n()),this._onDestroyCallbacks=[]}reset(n=void 0){this.control&&this.control.reset(n)}hasError(n,t){return!!this.control&&this.control.hasError(n,t)}getError(n,t){return this.control?this.control.getError(n,t):null}}class b extends ze{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class He{constructor(n){this._cd=n}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}}let Xe=(()=>{class e extends He{constructor(t){super(t)}static{this.\u0275fac=function(i){return new(i||e)(r.rXU(b,2))}}static{this.\u0275dir=r.FsC({type:e,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(i,s){2&i&&r.AVh("ng-untouched",s.isUntouched)("ng-touched",s.isTouched)("ng-pristine",s.isPristine)("ng-dirty",s.isDirty)("ng-valid",s.isValid)("ng-invalid",s.isInvalid)("ng-pending",s.isPending)},features:[r.Vt3]})}}return e})();const z="VALID",ot="INVALID",I="PENDING",H="DISABLED";function at(e){return null!=e&&!Array.isArray(e)&&"object"==typeof e}class kt{constructor(n,t){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._assignValidators(n),this._assignAsyncValidators(t)}get validator(){return this._composedValidatorFn}set validator(n){this._rawValidators=this._composedValidatorFn=n}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(n){this._rawAsyncValidators=this._composedAsyncValidatorFn=n}get parent(){return this._parent}get valid(){return this.status===z}get invalid(){return this.status===ot}get pending(){return this.status==I}get disabled(){return this.status===H}get enabled(){return this.status!==H}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(n){this._assignValidators(n)}setAsyncValidators(n){this._assignAsyncValidators(n)}addValidators(n){this.setValidators(Le(n,this._rawValidators))}addAsyncValidators(n){this.setAsyncValidators(Le(n,this._rawAsyncValidators))}removeValidators(n){this.setValidators(je(n,this._rawValidators))}removeAsyncValidators(n){this.setAsyncValidators(je(n,this._rawAsyncValidators))}hasValidator(n){return rt(this._rawValidators,n)}hasAsyncValidator(n){return rt(this._rawAsyncValidators,n)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(n={}){this.touched=!0,this._parent&&!n.onlySelf&&this._parent.markAsTouched(n)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(n=>n.markAllAsTouched())}markAsUntouched(n={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(t=>{t.markAsUntouched({onlySelf:!0})}),this._parent&&!n.onlySelf&&this._parent._updateTouched(n)}markAsDirty(n={}){this.pristine=!1,this._parent&&!n.onlySelf&&this._parent.markAsDirty(n)}markAsPristine(n={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(t=>{t.markAsPristine({onlySelf:!0})}),this._parent&&!n.onlySelf&&this._parent._updatePristine(n)}markAsPending(n={}){this.status=I,!1!==n.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!n.onlySelf&&this._parent.markAsPending(n)}disable(n={}){const t=this._parentMarkedDirty(n.onlySelf);this.status=H,this.errors=null,this._forEachChild(i=>{i.disable({...n,onlySelf:!0})}),this._updateValue(),!1!==n.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors({...n,skipPristineCheck:t}),this._onDisabledChange.forEach(i=>i(!0))}enable(n={}){const t=this._parentMarkedDirty(n.onlySelf);this.status=z,this._forEachChild(i=>{i.enable({...n,onlySelf:!0})}),this.updateValueAndValidity({onlySelf:!0,emitEvent:n.emitEvent}),this._updateAncestors({...n,skipPristineCheck:t}),this._onDisabledChange.forEach(i=>i(!1))}_updateAncestors(n){this._parent&&!n.onlySelf&&(this._parent.updateValueAndValidity(n),n.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(n){this._parent=n}getRawValue(){return this.value}updateValueAndValidity(n={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===z||this.status===I)&&this._runAsyncValidator(n.emitEvent)),!1!==n.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!n.onlySelf&&this._parent.updateValueAndValidity(n)}_updateTreeValidity(n={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(n)),this.updateValueAndValidity({onlySelf:!0,emitEvent:n.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?H:z}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(n){if(this.asyncValidator){this.status=I,this._hasOwnPendingAsyncValidator=!0;const t=Re(this.asyncValidator(this));this._asyncValidationSubscription=t.subscribe(i=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(i,{emitEvent:n})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(n,t={}){this.errors=n,this._updateControlsErrors(!1!==t.emitEvent)}get(n){let t=n;return null==t||(Array.isArray(t)||(t=t.split(".")),0===t.length)?null:t.reduce((i,s)=>i&&i._find(s),this)}getError(n,t){const i=t?this.get(t):this;return i&&i.errors?i.errors[n]:null}hasError(n,t){return!!this.getError(n,t)}get root(){let n=this;for(;n._parent;)n=n._parent;return n}_updateControlsErrors(n){this.status=this._calculateStatus(),n&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(n)}_initObservables(){this.valueChanges=new r.bkB,this.statusChanges=new r.bkB}_calculateStatus(){return this._allControlsDisabled()?H:this.errors?ot:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(I)?I:this._anyControlsHaveStatus(ot)?ot:z}_anyControlsHaveStatus(n){return this._anyControls(t=>t.status===n)}_anyControlsDirty(){return this._anyControls(n=>n.dirty)}_anyControlsTouched(){return this._anyControls(n=>n.touched)}_updatePristine(n={}){this.pristine=!this._anyControlsDirty(),this._parent&&!n.onlySelf&&this._parent._updatePristine(n)}_updateTouched(n={}){this.touched=this._anyControlsTouched(),this._parent&&!n.onlySelf&&this._parent._updateTouched(n)}_registerOnCollectionChange(n){this._onCollectionChange=n}_setUpdateStrategy(n){at(n)&&null!=n.updateOn&&(this._updateOn=n.updateOn)}_parentMarkedDirty(n){return!n&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}_find(n){return null}_assignValidators(n){this._rawValidators=Array.isArray(n)?n.slice():n,this._composedValidatorFn=function ir(e){return Array.isArray(e)?Et(e):e||null}(this._rawValidators)}_assignAsyncValidators(n){this._rawAsyncValidators=Array.isArray(n)?n.slice():n,this._composedAsyncValidatorFn=function rr(e){return Array.isArray(e)?Mt(e):e||null}(this._rawAsyncValidators)}}const M=new r.nKC("CallSetDisabledState",{providedIn:"root",factory:()=>X}),X="always";function W(e,n,t=X){(function Nt(e,n){const t=Ue(e);null!==n.validator?e.setValidators(Pe(t,n.validator)):"function"==typeof t&&e.setValidators([t]);const i=Ge(e);null!==n.asyncValidator?e.setAsyncValidators(Pe(i,n.asyncValidator)):"function"==typeof i&&e.setAsyncValidators([i]);const s=()=>e.updateValueAndValidity();ut(n._rawValidators,s),ut(n._rawAsyncValidators,s)})(e,n),n.valueAccessor.writeValue(e.value),(e.disabled||"always"===t)&&n.valueAccessor.setDisabledState?.(e.disabled),function ar(e,n){n.valueAccessor.registerOnChange(t=>{e._pendingValue=t,e._pendingChange=!0,e._pendingDirty=!0,"change"===e.updateOn&&qe(e,n)})}(e,n),function cr(e,n){const t=(i,s)=>{n.valueAccessor.writeValue(i),s&&n.viewToModelUpdate(i)};e.registerOnChange(t),n._registerOnDestroy(()=>{e._unregisterOnChange(t)})}(e,n),function lr(e,n){n.valueAccessor.registerOnTouched(()=>{e._pendingTouched=!0,"blur"===e.updateOn&&e._pendingChange&&qe(e,n),"submit"!==e.updateOn&&e.markAsTouched()})}(e,n),function or(e,n){if(n.valueAccessor.setDisabledState){const t=i=>{n.valueAccessor.setDisabledState(i)};e.registerOnDisabledChange(t),n._registerOnDestroy(()=>{e._unregisterOnDisabledChange(t)})}}(e,n)}function ct(e,n,t=!0){const i=()=>{};n.valueAccessor&&(n.valueAccessor.registerOnChange(i),n.valueAccessor.registerOnTouched(i)),function dt(e,n){let t=!1;if(null!==e){if(null!==n.validator){const s=Ue(e);if(Array.isArray(s)&&s.length>0){const o=s.filter(a=>a!==n.validator);o.length!==s.length&&(t=!0,e.setValidators(o))}}if(null!==n.asyncValidator){const s=Ge(e);if(Array.isArray(s)&&s.length>0){const o=s.filter(a=>a!==n.asyncValidator);o.length!==s.length&&(t=!0,e.setAsyncValidators(o))}}}const i=()=>{};return ut(n._rawValidators,i),ut(n._rawAsyncValidators,i),t}(e,n),e&&(n._invokeOnDestroyCallbacks(),e._registerOnCollectionChange(()=>{}))}function ut(e,n){e.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(n)})}function qe(e,n){e._pendingDirty&&e.markAsDirty(),e.setValue(e._pendingValue,{emitModelToViewChange:!1}),n.viewToModelUpdate(e._pendingValue),e._pendingChange=!1}function Ze(e,n){const t=e.indexOf(n);t>-1&&e.splice(t,1)}function Je(e){return"object"==typeof e&&null!==e&&2===Object.keys(e).length&&"value"in e&&"disabled"in e}Promise.resolve();const Lt=class extends kt{constructor(n=null,t,i){super(function Rt(e){return(at(e)?e.validators:e)||null}(t),function It(e,n){return(at(n)?n.asyncValidators:e)||null}(i,t)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(n),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),at(t)&&(t.nonNullable||t.initialValueIsDefault)&&(this.defaultValue=Je(n)?n.value:n)}setValue(n,t={}){this.value=this._pendingValue=n,this._onChange.length&&!1!==t.emitModelToViewChange&&this._onChange.forEach(i=>i(this.value,!1!==t.emitViewToModelChange)),this.updateValueAndValidity(t)}patchValue(n,t={}){this.setValue(n,t)}reset(n=this.defaultValue,t={}){this._applyFormState(n),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}_updateValue(){}_anyControls(n){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(n){this._onChange.push(n)}_unregisterOnChange(n){Ze(this._onChange,n)}registerOnDisabledChange(n){this._onDisabledChange.push(n)}_unregisterOnDisabledChange(n){Ze(this._onDisabledChange,n)}_forEachChild(n){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(n){Je(n)?(this.value=this._pendingValue=n.value,n.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=n}};Promise.resolve();const jt=new r.nKC(""),br={provide:b,useExisting:(0,r.Rfq)(()=>zt)};let zt=(()=>{class e extends b{set isDisabled(t){}static{this._ngModelWarningSentOnce=!1}constructor(t,i,s,o,a){super(),this._ngModelWarningConfig=o,this.callSetDisabledState=a,this.update=new r.bkB,this._ngModelWarningSent=!1,this._setValidators(t),this._setAsyncValidators(i),this.valueAccessor=function Ut(e,n){if(!n)return null;let t,i,s;return Array.isArray(n),n.forEach(o=>{o.constructor===nt?t=o:function hr(e){return Object.getPrototypeOf(e.constructor)===E}(o)?i=o:s=o}),s||i||t||null}(0,s)}ngOnChanges(t){if(this._isControlChanged(t)){const i=t.form.previousValue;i&&ct(i,this,!1),W(this.form,this,this.callSetDisabledState),this.form.updateValueAndValidity({emitEvent:!1})}(function Pt(e,n){if(!e.hasOwnProperty("model"))return!1;const t=e.model;return!!t.isFirstChange()||!Object.is(n,t.currentValue)})(t,this.viewModel)&&(this.form.setValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.form&&ct(this.form,this,!1)}get path(){return[]}get control(){return this.form}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}_isControlChanged(t){return t.hasOwnProperty("form")}static{this.\u0275fac=function(i){return new(i||e)(r.rXU(p,10),r.rXU(w,10),r.rXU(y,10),r.rXU(jt,8),r.rXU(M,8))}}static{this.\u0275dir=r.FsC({type:e,selectors:[["","formControl",""]],inputs:{form:[r.Mj6.None,"formControl","form"],isDisabled:[r.Mj6.None,"disabled","isDisabled"],model:[r.Mj6.None,"ngModel","model"]},outputs:{update:"ngModelChange"},exportAs:["ngForm"],features:[r.Jv_([br]),r.Vt3,r.OA$]})}}return e})(),Vn=(()=>{class e{static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275mod=r.$C({type:e})}static{this.\u0275inj=r.G2t({})}}return e})(),zr=(()=>{class e{static withConfig(t){return{ngModule:e,providers:[{provide:M,useValue:t.callSetDisabledState??X}]}}static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275mod=r.$C({type:e})}static{this.\u0275inj=r.G2t({imports:[Vn]})}}return e})(),Hr=(()=>{class e{static withConfig(t){return{ngModule:e,providers:[{provide:jt,useValue:t.warnOnNgModelWithFormControl??"always"},{provide:M,useValue:t.callSetDisabledState??X}]}}static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275mod=r.$C({type:e})}static{this.\u0275inj=r.G2t({imports:[Vn]})}}return e})();function Xr(e,n){if(1&e){const t=r.RV6();r.j41(0,"div")(1,"button",4),r.bIt("click",function(){r.eBV(t);const s=r.XpG();return r.Njj(s.setAnnotationType("text"))}),r.EFF(2,"text"),r.k0s(),r.j41(3,"button",4),r.bIt("click",function(){r.eBV(t);const s=r.XpG();return r.Njj(s.setAnnotationType("image"))}),r.EFF(4,"image"),r.k0s()()}}function Wr(e,n){if(1&e){const t=r.RV6();r.j41(0,"div",5)(1,"textarea",6),r.bIt("blur",function(){r.eBV(t);const s=r.XpG();return r.Njj(s.updateTextValue())}),r.k0s()()}if(2&e){const t=r.XpG();r.R7$(),r.Y8G("formControl",t.formControl)}}function $r(e,n){if(1&e){const t=r.RV6();r.j41(0,"input",10),r.bIt("change",function(s){r.eBV(t);const o=r.XpG(3);return r.Njj(o.onFileSelected(s))}),r.k0s()}}function Kr(e,n){if(1&e&&r.nrm(0,"img",11),2&e){const t=r.XpG(3);r.Y8G("src",t.imageSrc,r.B4B)}}function qr(e,n){if(1&e&&(r.j41(0,"div",5),r.DNE(1,$r,1,0,"input",8)(2,Kr,1,1,"img",9),r.k0s()),2&e){const t=r.XpG(2);r.R7$(),r.Y8G("ngIf",!t.imageSrc),r.R7$(),r.Y8G("ngIf",t.imageSrc)}}function Yr(e,n){if(1&e&&r.DNE(0,qr,3,2,"div",7),2&e){const t=r.XpG();r.Y8G("ngIf","image"===t.type)}}let Qr=(()=>{class e{constructor(t,i){this.elementRef=t,this.renderer=i,this.remove=new r.bkB,this.changed=new r.bkB,this.imageSrc=null,this.formControl=new Lt,this.annotationPositionX=null,this.annotationPositionY=null,this.onMouseDownHandler=()=>{this.annotationPositionX=this.annotationXCoordinate,this.annotationPositionY=this.annotationYCoordinate},this.onMouseMoveHandler=s=>{!this.annotationPositionX||!this.annotationPositionY||(this.annotationPositionX+=s.movementX,this.annotationPositionY+=s.movementY,this.setPosition(this.annotationPositionX,this.annotationPositionY))},this.onMouseUpHandler=()=>{this.stopMovement()},this.onMouseLeaveHandler=()=>{this.stopMovement()}}setPosition(t,i){this.annotationXCoordinate=t,this.annotationYCoordinate=i,this.renderer.setStyle(this.elementRef.nativeElement,"left",`${t}px`),this.renderer.setStyle(this.elementRef.nativeElement,"top",`${i}px`)}setSize(t,i){this.renderer.setStyle(this.elementRef.nativeElement,"width",`${t}px`),this.renderer.setStyle(this.elementRef.nativeElement,"height",`${i}px`),this.width=t,this.height=i}removeAnnotation(){this.remove.emit(this.id)}setAnnotationType(t){this.type=t}onFileSelected(t){const i=t.target;if(i.files&&i.files[0]){this.imageFile=i.files[0];const s=new FileReader;s.onload=()=>{this.imageSrc=s.result,this.changed.emit(this.id)},s.readAsDataURL(this.imageFile)}}updateTextValue(){this.changed.emit(this.id)}getSizes(){return{x:this.annotationXCoordinate,y:this.annotationYCoordinate,width:this.width,height:this.height}}getValue(){return"image"===this.type?this.imageFile:"text"===this.type?this.formControl.value:null}stopMovement(){this.annotationPositionX=null,this.annotationPositionY=null,this.changed.emit(this.id)}static{this.\u0275fac=function(i){return new(i||e)(r.rXU(r.aKT),r.rXU(r.sFG))}}static{this.\u0275cmp=r.VBU({type:e,selectors:[["app-annotation"]],hostBindings:function(i,s){1&i&&r.bIt("mousedown",function(a){return s.onMouseDownHandler(a)})("mousemove",function(a){return s.onMouseMoveHandler(a)})("mouseup",function(a){return s.onMouseUpHandler(a)})("mouseleave",function(a){return s.onMouseLeaveHandler(a)})},inputs:{id:"id"},outputs:{remove:"remove",changed:"changed"},decls:6,vars:3,consts:[["image",""],[1,"remove",3,"click"],[4,"ngIf"],["class","value-container",4,"ngIf","ngIfElse"],[3,"click"],[1,"value-container"],[1,"text-input",3,"blur","formControl"],["class","value-container",4,"ngIf"],["type","file","accept","image/*",3,"change",4,"ngIf"],["alt","Selected Image","class","image",3,"src",4,"ngIf"],["type","file","accept","image/*",3,"change"],["alt","Selected Image",1,"image",3,"src"]],template:function(i,s){if(1&i){const o=r.RV6();r.j41(0,"button",1),r.bIt("click",function(){return r.eBV(o),r.Njj(s.removeAnnotation())}),r.EFF(1,"x"),r.k0s(),r.DNE(2,Xr,5,0,"div",2)(3,Wr,2,1,"div",3)(4,Yr,1,1,"ng-template",null,0,r.C5r)}if(2&i){const o=r.sdS(5);r.R7$(2),r.Y8G("ngIf",!s.type),r.R7$(),r.Y8G("ngIf","text"===s.type)("ngIfElse",o)}},dependencies:[g.bT,nt,Xe,zt],styles:["[_nghost-%COMP%]{display:block;position:absolute;border:1px solid black}.remove[_ngcontent-%COMP%]{position:absolute;top:-24px;left:-24px;width:24px;height:24px}.image[_ngcontent-%COMP%]{width:auto;height:100%}.value-container[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:100%;height:100%}.text-input[_ngcontent-%COMP%]{width:100%;height:100%;border:none;background:none}"]})}}return e})();class wn{constructor(n){this.id=n.id,this.type=n.type,this.position=n.getSizes(),this.value=n.getValue()}}const Zr=["annotationsContainer"];let bn=(()=>{class e{constructor(t,i){this.viewContainerRef=t,this.annotationsService=i,this.isDrawing=!1,this.annotationRef=null,this.annotationRefs=new Map,this.destroyRef=(0,r.WQX)(r.abz),this.onMouseDownHandler=s=>{if(!this.isDrawing){this.isDrawing=!0,this.startX=s.offsetX,this.startY=s.offsetY,this.annotationRef=this.viewContainerRef.createComponent(Qr),this.annotationRef.instance.setPosition(this.startX,this.startY);const o=String(Date.now());this.annotationRef.instance.id=o,this.annotationRef.instance.remove.pipe(B(this.destroyRef)).subscribe(a=>{this.onRemoveAnnotation(a)}),this.annotationRef.instance.changed.pipe(B(this.destroyRef)).subscribe(a=>{this.onChangedAnnotation(a)}),this.annotationRefs.set(o,this.annotationRef)}},this.onMouseMoveHandler=s=>{this.isDrawing&&this.annotationRef&&this.annotationRef.instance.setSize(s.offsetX-this.startX,s.offsetY-this.startY)},this.onMouseUpHandler=s=>{this.isDrawing&&this.annotationRef&&(this.annotationRef.instance.setSize(s.offsetX-this.startX,s.offsetY-this.startY),this.annotationsService.saveTempAnnotation(this.documentId,this.pageNumber,new wn(this.annotationRef.instance)),this.isDrawing=!1,this.annotationRef=null)}}onRemoveAnnotation(t){const i=this.annotationRefs.get(t);i&&(this.annotationRefs.delete(t),this.annotationsService.deleteTempAnnotation(t),i.destroy())}onChangedAnnotation(t){const i=this.annotationRefs.get(t);i&&this.annotationsService.updateTempAnnotation(this.documentId,this.pageNumber,new wn(i.instance))}static{this.\u0275fac=function(i){return new(i||e)(r.rXU(r.c1b),r.rXU(re))}}static{this.\u0275cmp=r.VBU({type:e,selectors:[["app-annotations"]],viewQuery:function(i,s){if(1&i&&r.GBs(Zr,5),2&i){let o;r.mGM(o=r.lsd())&&(s.annotationsContainer=o.first)}},hostBindings:function(i,s){1&i&&r.bIt("mousedown",function(a){return s.onMouseDownHandler(a)})("mousemove",function(a){return s.onMouseMoveHandler(a)})("mouseup",function(a){return s.onMouseUpHandler(a)})},inputs:{documentId:"documentId",pageNumber:"pageNumber"},decls:2,vars:0,consts:[["annotationsContainer",""],[1,"annotations-container"]],template:function(i,s){1&i&&r.nrm(0,"div",1,0)},styles:["[_nghost-%COMP%]{position:relative;display:block;width:100%;height:100%}.annotations-container[_ngcontent-%COMP%]{width:100%;height:100%;position:absolute;opacity:.3}"]})}}return e})(),Jr=(()=>{class e{static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275cmp=r.VBU({type:e,selectors:[["app-page"]],inputs:{imageUrl:"imageUrl",documentId:"documentId",pageNumber:"pageNumber"},decls:2,vars:3,consts:[[3,"src"],[3,"documentId","pageNumber"]],template:function(i,s){1&i&&r.nrm(0,"img",0)(1,"app-annotations",1),2&i&&(r.Y8G("src","assets/"+s.imageUrl,r.B4B),r.R7$(),r.Y8G("documentId",s.documentId)("pageNumber",s.pageNumber))},dependencies:[bn],styles:["[_nghost-%COMP%]{display:flex;align-items:center;justify-content:center;position:relative;width:100%}[_nghost-%COMP%]   img[_ngcontent-%COMP%]{height:100%;width:auto}app-annotations[_ngcontent-%COMP%]{display:block;position:absolute;top:0;left:0;width:100%;height:100%}"]})}}return e})();const ts=e=>({"height.px":e});function es(e,n){1&e&&(r.j41(0,"div"),r.EFF(1,"Is loading"),r.k0s())}function ns(e,n){if(1&e&&(r.j41(0,"div",8),r.nrm(1,"app-page",9),r.k0s()),2&e){const t=n.$implicit,i=r.XpG(2);r.R7$(),r.Y8G("imageUrl",t.imageUrl)("ngStyle",r.eq3(4,ts,i.pageSizeInPx))("pageNumber",t.number)("documentId",i.documentId)}}function is(e,n){if(1&e){const t=r.RV6();r.j41(0,"div",2)(1,"h2"),r.EFF(2),r.k0s(),r.j41(3,"div")(4,"button",3),r.bIt("click",function(){r.eBV(t);const s=r.XpG();return r.Njj(s.zoomInHandler())}),r.EFF(5,"+"),r.k0s(),r.j41(6,"button",3),r.bIt("click",function(){r.eBV(t);const s=r.XpG();return r.Njj(s.zoomOutHandler())}),r.EFF(7,"-"),r.k0s(),r.j41(8,"button",4),r.bIt("click",function(){r.eBV(t);const s=r.XpG();return r.Njj(s.saveAnnotations())}),r.EFF(9,"Save"),r.k0s()()(),r.j41(10,"div",5)(11,"cdk-virtual-scroll-viewport",6),r.DNE(12,ns,2,6,"div",7),r.k0s()()}if(2&e){const t=r.XpG();r.R7$(2),r.JRh(t.pageTitle),r.R7$(2),r.Y8G("disabled",t.pageSizeInPx>=t.maxHeight),r.R7$(2),r.Y8G("disabled",t.pageSizeInPx<=t.minHeight),r.R7$(5),r.FS9("itemSize",300),r.R7$(),r.Y8G("cdkVirtualForOf",t.pages)("cdkVirtualForTrackBy",t.trackByFn)}}const rs=[{path:"",component:(()=>{class e{constructor(t,i,s){this.route=t,this.documentApi=i,this.annotationsService=s,this.isLoading=!0,this.pageSizeInPx=1040,this.maxHeight=1500,this.minHeight=900,this.scale=1,this.documentId=this.route.snapshot.params.id,this.documentApi.getDocument(this.documentId).pipe(B()).subscribe(o=>{this.pages=o.pages,this.pageTitle=o.name,this.isLoading=!1})}trackByFn(t,i){return i.number}zoomInHandler(){this.zoomSetup()}zoomOutHandler(){this.zoomSetup(!0)}saveAnnotations(){var t=this;return(0,Sn.A)(function*(){const i=yield t.annotationsService.saveAnnotations(t.documentId);console.log(i)})()}zoomSetup(t){this.pageSizeInPx=t?Math.max(this.minHeight,this.pageSizeInPx-100):Math.min(this.maxHeight,this.pageSizeInPx+100)}static{this.\u0275fac=function(i){return new(i||e)(r.rXU(T.nX),r.rXU(ie),r.rXU(re))}}static{this.\u0275cmp=r.VBU({type:e,selectors:[["app-document"]],decls:3,vars:2,consts:[["viewer",""],[4,"ngIf","ngIfElse"],[1,"menu"],[3,"click","disabled"],[3,"click"],[1,"page"],[1,"virtual-viewport",3,"itemSize"],["class","viewport-item",4,"cdkVirtualFor","cdkVirtualForOf","cdkVirtualForTrackBy"],[1,"viewport-item"],[3,"imageUrl","ngStyle","pageNumber","documentId"]],template:function(i,s){if(1&i&&r.DNE(0,es,2,0,"div",1)(1,is,13,6,"ng-template",null,0,r.C5r),2&i){const o=r.sdS(2);r.Y8G("ngIf",s.isLoading)("ngIfElse",o)}},dependencies:[g.bT,g.B3,Ri,Ui,_e,Jr],styles:["[_nghost-%COMP%]{display:block;height:100%}.menu[_ngcontent-%COMP%]{height:50px;display:flex;justify-content:space-between;align-items:center;position:sticky;top:0;border:2px solid black}.page[_ngcontent-%COMP%]{height:calc(100vh - 50px)}.virtual-viewport[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;height:100%;width:100%;border:1px solid black}.viewport-item[_ngcontent-%COMP%]{height:100%}"]})}}return e})()}];let ss=(()=>{class e{static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275mod=r.$C({type:e})}static{this.\u0275inj=r.G2t({imports:[T.iI.forChild(rs),T.iI]})}}return e})();const os=[{path:"",component:bn}];let as=(()=>{class e{static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275mod=r.$C({type:e})}static{this.\u0275inj=r.G2t({imports:[T.iI.forChild(os),T.iI]})}}return e})(),ls=(()=>{class e{static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275mod=r.$C({type:e})}static{this.\u0275inj=r.G2t({imports:[g.MD,as,zr,Hr]})}}return e})(),cs=(()=>{class e{static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275mod=r.$C({type:e})}static{this.\u0275inj=r.G2t({providers:[ie,ne],imports:[g.MD,ss,Gi,ls]})}}return e})()}}]);